# QwenASRAPP 打包说明（简化版）

## 📦 项目结构

现在采用简单的打包方式：**EXE + dist 文件夹**

```
发布文件夹/
├── QwenASRAPP.exe                          # 主程序
├── QwenASRAPP.exe.config                   # 配置文件
├── Microsoft.Web.WebView2.Core.dll         # WebView2 依赖
├── Microsoft.Web.WebView2.Wpf.dll          # WebView2 依赖
├── Microsoft.Web.WebView2.WinForms.dll     # WebView2 依赖
└── dist/                                   # 前端资源文件夹
    ├── index.html
    └── assets/
        ├── index-C2phr4eZ.js
        └── manifest-zn1fOMRQ.json
```

## 🚀 打包步骤

### 1. 清理并重新生成

在 Visual Studio 中：
1. **生成 > 清理解决方案**
2. **生成 > 重新生成解决方案** (Ctrl + Shift + B)

### 2. 选择发布配置

- **Debug 模式**：用于开发调试
- **Release 模式**：用于最终发布（推荐）
  - 在工具栏选择 "Release"
  - 重新生成解决方案

### 3. 获取发布文件

编译后的文件位置：
- **Debug**: `bin\Debug\`
- **Release**: `bin\Release\`

需要复制的文件：
```
bin\Release\
├── QwenASRAPP.exe          ✓ 主程序
├── QwenASRAPP.exe.config   ✓ 配置文件
├── *.dll                   ✓ 所有 DLL 文件
└── dist\                   ✓ 整个 dist 文件夹
```

### 4. 打包分发

创建发布文件夹，将以上文件复制到一起：
```
QwenASR-v1.0/
├── QwenASRAPP.exe
├── QwenASRAPP.exe.config
├── Microsoft.Web.WebView2.*.dll (3个文件)
└── dist/
```

然后压缩成 ZIP 文件即可分发。

## ⚠️ 重要依赖

### WebView2 Runtime

**用户必须安装 WebView2 Runtime！**

**方案 1：自动检测并提示用户安装**（推荐）
- 用户运行程序时，如果未安装 WebView2 会自动提示
- 下载地址：https://developer.microsoft.com/microsoft-edge/webview2/

**方案 2：打包 Bootstrapper 一起分发**
- 下载 Evergreen Bootstrapper（约 2MB）
- 下载地址：https://go.microsoft.com/fwlink/p/?LinkId=2124703
- 放在发布文件夹中，提示用户先运行安装

**方案 3：在安装包中集成**
- 如果制作安装程序（如 Inno Setup），可以在安装时自动安装 WebView2

### .NET Framework 4.6.2

大多数 Windows 10/11 系统已预装，如果目标系统没有：
- 下载地址：https://dotnet.microsoft.com/download/dotnet-framework/net462

## 🧪 测试步骤

### 1. 本地测试
- 在 Visual Studio 中运行（F5）
- 确认应用能正常加载和显示

### 2. 模拟分发测试
- 将 `bin\Release\` 中的所有文件复制到桌面新建文件夹
- 在新位置运行 `QwenASRAPP.exe`
- 确认能正常工作

### 3. 其他设备测试
- 复制发布文件夹到另一台电脑
- 确保该电脑已安装：
  - WebView2 Runtime
  - .NET Framework 4.6.2
- 运行测试

## 📝 文件大小参考

- QwenASRAPP.exe: ~10 KB
- WebView2 DLL 文件: ~950 KB
- dist 文件夹: ~365 KB
- **总计**: ~1.3 MB

## 🔧 调试选项

如果需要调试前端问题，在 [MainWindow.xaml.cs:33](MainWindow.xaml.cs#L33) 取消注释：
```csharp
webView.CoreWebView2.OpenDevToolsWindow();
```

这将打开开发者工具，可以查看控制台错误和网络请求。

## 常见问题

### Q: 程序打不开或闪退
**A:** 检查是否安装了 WebView2 Runtime 和 .NET Framework 4.6.2

### Q: 页面显示空白
**A:**
1. 检查 dist 文件夹是否与 EXE 在同一目录
2. 检查 dist/index.html 是否存在
3. 取消注释开发者工具查看具体错误

### Q: 移动到其他设备无法使用
**A:** 确保复制了：
1. QwenASRAPP.exe
2. QwenASRAPP.exe.config
3. 所有 .dll 文件
4. 完整的 dist 文件夹

### Q: 缺少 DLL 文件
**A:** 重新生成解决方案，确保所有 NuGet 包已正确恢复

## ✅ 发布检查清单

- [ ] 已切换到 Release 配置
- [ ] 已重新生成解决方案
- [ ] EXE 文件存在且可运行
- [ ] dist 文件夹已自动复制到输出目录
- [ ] 所有 WebView2 DLL 文件都在
- [ ] 本地测试通过
- [ ] 模拟分发测试通过
- [ ] 准备好 WebView2 Runtime 安装说明

---

现在采用的是最简单可靠的打包方式，所有依赖都是外部文件，易于调试和维护。
